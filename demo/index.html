<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Laravel Erd</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
        }
    </style>
</head>
<body>
<erd-editor automatic-layout system-dark-mode enable-theme-builder></erd-editor>
<script>
    const checkModuleSupport = () => 'supports' in HTMLScriptElement
        ? HTMLScriptElement.supports('module')
        : 'noModule' in document.createElement('script');

    const createScript = (src) => {
        return checkModuleSupport()
            ? import(src)
            : new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.onload = () => resolve();
                script.onerror = () => reject();
                script.src = src;
                document.body.appendChild(script);
            });
    };

    const loader = (src, fallback) => {
        return createScript(src).catch(() => createScript(fallback));
    };

    const sql = atob('Q1JFQVRFIFRBQkxFIGNhcnMgKAogICAgaWQgaW50ZWdlcigxMSkgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsCiAgICBtb2RlbCB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICBtZWNoYW5pY19pZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCwKICAgIFBSSU1BUlkgS0VZKGlkKQopCkNSRUFURSBUQUJMRSBjb21tZW50cyAoCiAgICBpZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCBBVVRPX0lOQ1JFTUVOVCwKICAgIHBvc3RfaWQgaW50ZWdlcigxMSkgTk9UIE5VTEwsCiAgICB0aXRsZSB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICBjcmVhdGVkX2F0IGRhdGV0aW1lLAogICAgdXBkYXRlZF9hdCBkYXRldGltZSwKICAgIFBSSU1BUlkgS0VZKGlkKQopCkNSRUFURSBUQUJMRSBpbWFnZXMgKAogICAgaWQgaW50ZWdlcigxMSkgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsCiAgICB1cmwgdmFyY2hhcigyNTUpIE5PVCBOVUxMLAogICAgaW1hZ2VhYmxlX3R5cGUgdmFyY2hhcigyNTUpIE5PVCBOVUxMLAogICAgaW1hZ2VhYmxlX2lkIGludGVnZXIoMTEpIE5PVCBOVUxMLAogICAgY3JlYXRlZF9hdCBkYXRldGltZSwKICAgIHVwZGF0ZWRfYXQgZGF0ZXRpbWUsCiAgICBQUklNQVJZIEtFWShpZCkKKQpDUkVBVEUgVEFCTEUgbWVjaGFuaWNzICgKICAgIGlkIGludGVnZXIoMTEpIE5PVCBOVUxMIEFVVE9fSU5DUkVNRU5ULAogICAgbmFtZSB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICBQUklNQVJZIEtFWShpZCkKKQpDUkVBVEUgVEFCTEUgbW9kZWxfaGFzX3Blcm1pc3Npb25zICgKICAgIHBlcm1pc3Npb25faWQgaW50ZWdlcigxMSkgTk9UIE5VTEwsCiAgICBtb2RlbF90eXBlIHZhcmNoYXIoMjU1KSBOT1QgTlVMTCwKICAgIG1vZGVsX2lkIGludGVnZXIoMTEpIE5PVCBOVUxMLAogICAgUFJJTUFSWSBLRVkocGVybWlzc2lvbl9pZCwgbW9kZWxfaWQsIG1vZGVsX3R5cGUpCikKQ1JFQVRFIFRBQkxFIG1vZGVsX2hhc19yb2xlcyAoCiAgICByb2xlX2lkIGludGVnZXIoMTEpIE5PVCBOVUxMLAogICAgbW9kZWxfdHlwZSB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICBtb2RlbF9pZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCwKICAgIFBSSU1BUlkgS0VZKHJvbGVfaWQsIG1vZGVsX2lkLCBtb2RlbF90eXBlKQopCkNSRUFURSBUQUJMRSBvd25lcnMgKAogICAgaWQgaW50ZWdlcigxMSkgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsCiAgICBuYW1lIHZhcmNoYXIoMjU1KSBOT1QgTlVMTCwKICAgIGNhcl9pZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCwKICAgIFBSSU1BUlkgS0VZKGlkKQopCkNSRUFURSBUQUJMRSBwZXJtaXNzaW9ucyAoCiAgICBpZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCBBVVRPX0lOQ1JFTUVOVCwKICAgIG5hbWUgdmFyY2hhcigyNTUpIE5PVCBOVUxMLAogICAgZ3VhcmRfbmFtZSB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICBjcmVhdGVkX2F0IGRhdGV0aW1lLAogICAgdXBkYXRlZF9hdCBkYXRldGltZSwKICAgIFBSSU1BUlkgS0VZKGlkKQopCkNSRUFURSBUQUJMRSBwaG9uZXMgKAogICAgaWQgaW50ZWdlcigxMSkgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsCiAgICB1c2VyX2lkIGludGVnZXIoMTEpIE5PVCBOVUxMLAogICAgcGhvbmVfbnVtYmVycyB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICBQUklNQVJZIEtFWShpZCkKKQpDUkVBVEUgVEFCTEUgcG9zdHMgKAogICAgaWQgaW50ZWdlcigxMSkgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsCiAgICB1c2VyX2lkIGludGVnZXIoMTEpIE5PVCBOVUxMLAogICAgdGl0bGUgdmFyY2hhcigyNTUpIE5PVCBOVUxMIERFRkFVTFQgZm9vLAogICAgY3JlYXRlZF9hdCBkYXRldGltZSwKICAgIHVwZGF0ZWRfYXQgZGF0ZXRpbWUsCiAgICBQUklNQVJZIEtFWShpZCkKKQpDUkVBVEUgVEFCTEUgcm9sZV9oYXNfcGVybWlzc2lvbnMgKAogICAgcGVybWlzc2lvbl9pZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCwKICAgIHJvbGVfaWQgaW50ZWdlcigxMSkgTk9UIE5VTEwsCiAgICBQUklNQVJZIEtFWShwZXJtaXNzaW9uX2lkLCByb2xlX2lkKQopCkNSRUFURSBUQUJMRSByb2xlcyAoCiAgICBpZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCBBVVRPX0lOQ1JFTUVOVCwKICAgIG5hbWUgdmFyY2hhcigyNTUpIE5PVCBOVUxMLAogICAgZ3VhcmRfbmFtZSB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICBjcmVhdGVkX2F0IGRhdGV0aW1lLAogICAgdXBkYXRlZF9hdCBkYXRldGltZSwKICAgIFBSSU1BUlkgS0VZKGlkKQopCkNSRUFURSBUQUJMRSB1c2VycyAoCiAgICBpZCBpbnRlZ2VyKDExKSBOT1QgTlVMTCBBVVRPX0lOQ1JFTUVOVCwKICAgIG5hbWUgdmFyY2hhcigyNTUpIE5PVCBOVUxMLAogICAgZW1haWwgdmFyY2hhcigyNTUpIE5PVCBOVUxMLAogICAgZW1haWxfdmVyaWZpZWRfYXQgZGF0ZXRpbWUsCiAgICBwYXNzd29yZCB2YXJjaGFyKDI1NSkgTk9UIE5VTEwsCiAgICByZW1lbWJlcl90b2tlbiB2YXJjaGFyKDI1NSksCiAgICBjcmVhdGVkX2F0IGRhdGV0aW1lLAogICAgdXBkYXRlZF9hdCBkYXRldGltZSwKICAgIFBSSU1BUlkgS0VZKGlkKQopCkFMVEVSIFRBQkxFIGNhcnMgQUREIEZPUkVJR04gS0VZIChpZCkgUkVGRVJFTkNFUyBvd25lcnMgKGNhcl9pZCkKQUxURVIgVEFCTEUgY2FycyBBREQgRk9SRUlHTiBLRVkgKG1lY2hhbmljX2lkKSBSRUZFUkVOQ0VTIG1lY2hhbmljcyAoaWQpCkFMVEVSIFRBQkxFIGNvbW1lbnRzIEFERCBGT1JFSUdOIEtFWSAocG9zdF9pZCkgUkVGRVJFTkNFUyBwb3N0cyAoaWQpCkFMVEVSIFRBQkxFIGltYWdlcyBBREQgRk9SRUlHTiBLRVkgKGltYWdlYWJsZV9pZCkgUkVGRVJFTkNFUyBwb3N0cyAoaWQpCkFMVEVSIFRBQkxFIGltYWdlcyBBREQgRk9SRUlHTiBLRVkgKGltYWdlYWJsZV9pZCkgUkVGRVJFTkNFUyB1c2VycyAoaWQpCkFMVEVSIFRBQkxFIG1vZGVsX2hhc19wZXJtaXNzaW9ucyBBREQgRk9SRUlHTiBLRVkgKG1vZGVsX2lkKSBSRUZFUkVOQ0VTIHVzZXJzIChpZCkKQUxURVIgVEFCTEUgbW9kZWxfaGFzX3Blcm1pc3Npb25zIEFERCBGT1JFSUdOIEtFWSAocGVybWlzc2lvbl9pZCkgUkVGRVJFTkNFUyBwZXJtaXNzaW9ucyAoaWQpCkFMVEVSIFRBQkxFIG1vZGVsX2hhc19yb2xlcyBBREQgRk9SRUlHTiBLRVkgKG1vZGVsX2lkKSBSRUZFUkVOQ0VTIHVzZXJzIChpZCkKQUxURVIgVEFCTEUgbW9kZWxfaGFzX3JvbGVzIEFERCBGT1JFSUdOIEtFWSAocm9sZV9pZCkgUkVGRVJFTkNFUyByb2xlcyAoaWQpCkFMVEVSIFRBQkxFIHBlcm1pc3Npb25zIEFERCBGT1JFSUdOIEtFWSAoaWQpIFJFRkVSRU5DRVMgcm9sZV9oYXNfcGVybWlzc2lvbnMgKHBlcm1pc3Npb25faWQpCkFMVEVSIFRBQkxFIHBob25lcyBBREQgRk9SRUlHTiBLRVkgKHVzZXJfaWQpIFJFRkVSRU5DRVMgdXNlcnMgKGlkKQpBTFRFUiBUQUJMRSBwb3N0cyBBREQgRk9SRUlHTiBLRVkgKHVzZXJfaWQpIFJFRkVSRU5DRVMgdXNlcnMgKGlkKQpBTFRFUiBUQUJMRSByb2xlX2hhc19wZXJtaXNzaW9ucyBBREQgRk9SRUlHTiBLRVkgKHJvbGVfaWQpIFJFRkVSRU5DRVMgcm9sZXMgKGlkKQ==');
    const editor = document.querySelector('erd-editor');

    if (checkModuleSupport()) {
        const scripts = [[
            '../resources/dist/erd-editor.esm.js',
            'https://cdn.jsdelivr.net/npm/@dineug/erd-editor/+esm',
        ], [
            '../resources/dist/erd-editor-shiki-worker.esm.js',
            'https://cdn.jsdelivr.net/npm/@dineug/erd-editor-shiki-worker/+esm',
        ]].map(([src, fallback]) => loader(src, fallback));

        Promise.all(scripts)
            .then(([{ setGetShikiServiceCallback }, { getShikiService }]) => setGetShikiServiceCallback(getShikiService))
            .then(() => editor.setSchemaSQL(sql));
    } else {
        const scripts = [[
            '../resources/dist/vuerd.min.js',
            'https://cdn.jsdelivr.net/npm/vuerd/dist/vuerd.min.js',
        ]].map(([src, fallback]) => loader(src, fallback));

        Promise.all(scripts).then(() => editor.loadSQLDDL(sql));
    }
</script>
</body>
</html>